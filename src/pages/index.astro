---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const recentPosts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 4);
---

<!doctype html>
<html lang="ko">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			.hero {
				padding: 5em 1em 4em;
				max-width: 760px;
				margin: 0 auto;
				text-align: center;
			}
			.hero-badge {
				display: inline-block;
				background: rgba(124, 58, 237, 0.12);
				color: var(--accent-light);
				border: 1px solid rgba(124, 58, 237, 0.3);
				border-radius: 20px;
				padding: 4px 14px;
				font-size: 0.8em;
				font-weight: 700;
				letter-spacing: 0.08em;
				text-transform: uppercase;
				margin-bottom: 1.2em;
			}
			.hero h1 {
				font-size: clamp(2.2em, 6vw, 3.5em);
				margin-bottom: 0.6em;
				line-height: 1.15;
				background: linear-gradient(135deg, rgb(var(--black)) 0%, var(--accent-light) 100%);
				-webkit-background-clip: text;
				-webkit-text-fill-color: transparent;
				background-clip: text;
			}
			.hero p {
				font-size: 1.15em;
				color: rgb(var(--gray));
				max-width: 520px;
				margin: 0 auto 2em;
				line-height: 1.7;
			}
			.hero-cta {
				display: flex;
				gap: 1em;
				justify-content: center;
				flex-wrap: wrap;
			}
			.btn-primary {
				background: var(--accent);
				color: white;
				padding: 0.7em 1.6em;
				border-radius: 8px;
				text-decoration: none;
				font-weight: 700;
				font-size: 0.95em;
				transition: background 0.2s, transform 0.1s;
			}
			.btn-primary:hover {
				background: var(--accent-dark);
				color: white;
				transform: translateY(-1px);
			}
			.btn-secondary {
				background: transparent;
				color: rgb(var(--gray-dark));
				padding: 0.7em 1.6em;
				border-radius: 8px;
				text-decoration: none;
				font-weight: 700;
				font-size: 0.95em;
				border: 1px solid rgba(124, 58, 237, 0.3);
				transition: border-color 0.2s, color 0.2s;
			}
			.btn-secondary:hover {
				border-color: var(--accent-light);
				color: var(--accent-light);
			}
			.divider {
				border: none;
				border-top: 1px solid rgba(124, 58, 237, 0.12);
				margin: 0;
			}
			.recent-posts {
				max-width: 760px;
				margin: 0 auto;
				padding: 3em 1em 5em;
			}
			.section-header {
				display: flex;
				align-items: baseline;
				justify-content: space-between;
				margin-bottom: 2em;
			}
			.section-title {
				font-size: 1.1em;
				font-weight: 700;
				color: rgb(var(--gray));
				text-transform: uppercase;
				letter-spacing: 0.1em;
				margin: 0;
			}
			.view-all {
				font-size: 0.85em;
				color: var(--accent-light);
				text-decoration: none;
			}
			.view-all:hover {
				color: var(--accent-cyan);
			}
			.post-list {
				display: flex;
				flex-direction: column;
				gap: 0;
			}
			.post-item {
				display: flex;
				gap: 1.5em;
				align-items: flex-start;
				padding: 1.5em 0;
				border-bottom: 1px solid rgba(124, 58, 237, 0.08);
				text-decoration: none;
				transition: background 0.15s;
				border-radius: 4px;
			}
			.post-item:last-child {
				border-bottom: none;
			}
			.post-thumb {
				width: 100px;
				height: 70px;
				border-radius: 8px;
				object-fit: cover;
				flex-shrink: 0;
				background: rgba(124, 58, 237, 0.1);
			}
			.post-thumb-placeholder {
				width: 100px;
				height: 70px;
				border-radius: 8px;
				flex-shrink: 0;
				background: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(6, 182, 212, 0.1));
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 1.5em;
			}
			.post-meta {
				flex: 1;
				min-width: 0;
			}
			.post-date {
				font-size: 0.78em;
				color: rgb(var(--gray));
				margin-bottom: 0.3em;
			}
			.post-title {
				font-size: 1.05em;
				font-weight: 700;
				color: rgb(var(--black));
				line-height: 1.35;
				margin-bottom: 0.4em;
				transition: color 0.15s;
			}
			.post-item:hover .post-title {
				color: var(--accent-light);
			}
			.post-desc {
				font-size: 0.88em;
				color: rgb(var(--gray));
				line-height: 1.5;
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}
			@media (max-width: 520px) {
				.post-thumb,
				.post-thumb-placeholder {
					display: none;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<section class="hero">
				<div class="hero-badge">Tech & Vibe Coding</div>
				<h1>AI로 코딩하는<br />새로운 방식</h1>
				<p>
					바이브코딩, AI 툴 실전 활용, 개발자 생산성 — 직접 쓰고 부딪히며 알게 된 것들을 솔직하게 씁니다.
				</p>
				<div class="hero-cta">
					<a href="/blog" class="btn-primary">글 읽기</a>
					<a href="/about" class="btn-secondary">블로그 소개</a>
				</div>
			</section>

			<hr class="divider" />

			{recentPosts.length > 0 && (
				<section class="recent-posts">
					<div class="section-header">
						<h2 class="section-title">최근 글</h2>
						<a href="/blog" class="view-all">전체 보기 →</a>
					</div>
					<div class="post-list">
						{recentPosts.map((post) => (
							<a href={`/blog/${post.id}/`} class="post-item">
								{post.data.heroImage
									? <img class="post-thumb" src={post.data.heroImage} alt="" loading="lazy" />
									: <div class="post-thumb-placeholder">✦</div>
								}
								<div class="post-meta">
									<div class="post-date"><FormattedDate date={post.data.pubDate} /></div>
									<div class="post-title">{post.data.title}</div>
									<div class="post-desc">{post.data.description}</div>
								</div>
							</a>
						))}
					</div>
				</section>
			)}
		</main>
		<Footer />
	</body>
</html>
